<?xml version="1.0" encoding="UTF-8"?>
<graphSchema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="datastream-1.0.xsd">

    <objectCollection name="dataset">

        <objectGraph name="system" class="org.msh.etbm.entities.ServerSignature" />
        
        <objectGraph name="version" class="org.msh.etbm.entities.EntityLastVersion">
            <property name="entityClass" elementName="entity" xmlAttribute="true" />
            <property name="lastVersion" elementName="number" xmlAttribute="true" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <!-- TB CASES -->
        <objectGraph name="tbcase" class="org.msh.etbm.entities.TbCase">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="version" use="IGNORE" />
            <property name="patient" >
                <objectGraph name="patient" class="org.msh.etbm.entities.Patient">
            		<property name="syncData.serverId" elementName="id" xmlAttribute="true" use="REQUIRED" />
            		<property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            		<property name="cases" use="IGNORE" />
            		<property name="workspace" use="IGNORE" />
            		<property name="name.name" elementName="name" />
            		<property name="name.middleName" elementName="middleName" />
            		<property name="name.lastName" elementName="lastName" />
            	</objectGraph>
            </property>
            <property name="classification" xmlAttribute="true" />
            <property name="state" xmlAttribute="true" />
            <property name="patientType" xmlAttribute="true" />
            <property name="diagnosisType" xmlAttribute="true" />
            <property name="infectionSite" xmlAttribute="true" />
            <property name="treatmentPeriod.iniDate" elementName="iniTreatDate"/>
            <property name="treatmentPeriod.endDate" elementName="endTreatDate"/>
            <property name="regimen.id" elementName="regimen" />
            <property name="regimenIni.id" elementName="regimenini" />
            <property name="ownerUnit.id" elementName="ownerunit" xmlAttribute="true"/>
            <property name="pulmonaryType.id" elementName="pulmonaryType" />
            <property name="extrapulmonaryType.value" elementName="extrapulmonaryType" />
            <property name="extrapulmonaryType.complement" elementName="extrapulmonaryTypeCompl" />
            <property name="extrapulmonaryType2.value" elementName="extrapulmonaryType2" />
            <property name="extrapulmonaryType2.complement" elementName="extrapulmonaryType2Compl" />
            <property name="notificationUnit.id" elementName="notificationUnit" />
            <property name="healthUnits" use="IGNORE" />
            <property name="prescribedMedicines" use="IGNORE" />
            <property name="sideEffects" use="IGNORE" />
            <property name="comorbidities" use="IGNORE" />
            <property name="examinations" use="IGNORE" />
            <property name="resXRay" use="IGNORE" />
            <property name="contacts" use="IGNORE" />
            <property name="treatmentMonitoring" use="IGNORE" />
            <property name="resHIV" use="IGNORE" />
            <property name="examsCulture" use="IGNORE" />
            <property name="examsMicroscopy" use="IGNORE" />
            <property name="examsDST" use="IGNORE" />
            <property name="tags" use="IGNORE" />
            <property name="customProperties" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="examdst" class="org.msh.etbm.entities.ExamDST">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="dateCollected" xmlAttribute="true" />
            <property name="numResistant" use="IGNORE" />
            <property name="numContaminated" use="IGNORE" />
            <property name="numSusceptible" use="IGNORE" />
            <property name="results" >
        		<objectGraph name="dstresult" class="org.msh.etbm.entities.ExamDSTResult" parentProperty="exam">
            		<property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            		<property name="syncData.serverId" elementName="id" xmlAttribute="true" />
            		<property name="substance.id" elementName="substance" use="REQUIRED" xmlAttribute="true"/>
            		<property name="result" use="REQUIRED" xmlAttribute="true"/>
        		</objectGraph>
            </property>
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
        </objectGraph>
        
        
        <objectGraph name="exammicroscopy" class="org.msh.etbm.entities.ExamMicroscopy">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="result" xmlAttribute="true" />
            <property name="dateCollected" xmlAttribute="true" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
        </objectGraph>

        
        <objectGraph name="examxpert" class="org.msh.etbm.entities.ExamXpert">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="result" xmlAttribute="true" />
            <property name="rifResult" xmlAttribute="true" />
            <property name="dateCollected" xmlAttribute="true" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
        </objectGraph>
        
        <objectGraph name="examculture" class="org.msh.etbm.entities.ExamCulture" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="dateCollected" xmlAttribute="true" />
            <property name="result" xmlAttribute="true" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
        </objectGraph>
        
        <objectGraph name="examhiv" class="org.msh.etbm.entities.ExamHIV">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="result" xmlAttribute="true" />
        </objectGraph>
        
        <objectGraph name="treatmonitoring" class="org.msh.etbm.entities.TreatmentMonitoring" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
        </objectGraph>
        
        <objectGraph name="healthunit" class="org.msh.etbm.entities.TreatmentHealthUnit" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbunit.id" elementName="tbunit" use="REQUIRED" xmlAttribute="true"/>
            <property name="transferring" elementName="transf" xmlAttribute="true" />
            <property name="period.iniDate" elementName="iniDate" use="REQUIRED" />
            <property name="period.endDate" elementName="endDate" use="REQUIRED" />
        </objectGraph>
        
        <objectGraph name="presc-med" class="org.msh.etbm.entities.PrescribedMedicine" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="medicine.id" elementName="medicine" use="REQUIRED" xmlAttribute="true"/>
            <property name="period.iniDate" elementName="iniDate" use="REQUIRED" />
            <property name="period.endDate" elementName="endDate" use="REQUIRED" xmlAttribute="true"/>
            <property name="source.id" elementName="source" use="REQUIRED" />
            <property name="doseUnit" use="REQUIRED" xmlAttribute="true"/>
            <property name="frequency" use="REQUIRED" xmlAttribute="true"/>
        </objectGraph>
        
        <objectGraph name="address" class="org.msh.etbm.entities.Address">
            <property name="adminUnit.id" elementName="adminunit" />
        </objectGraph>
        
        <objectGraph name="contact" class="org.msh.etbm.entities.TbContact" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="contactType.id" elementName="contactType" />
            <property name="conduct.id" elementName="conduct" />
        </objectGraph>
        
        <objectGraph name="examxray" class="org.msh.etbm.entities.ExamXRay">
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="presentation.id" elementName="presentation" />
        </objectGraph>
        
        <objectGraph name="medexam" class="org.msh.etbm.entities.MedicalExamination" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
        </objectGraph>
        
        <objectGraph name="sideEffect" class="org.msh.etbm.entities.CaseSideEffect" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"/>
            <property name="sideEffect.value.id" elementName="sideeffect" xmlAttribute="true"/>
            <property name="sideEffect.complement" elementName="complement" />
            <property name="substance.id" elementName="substance" />
            <property name="substance2.id" elementName="substance2" />
        </objectGraph>

        <objectGraph name="comorbidity" class="org.msh.etbm.entities.CaseComorbidity" >
            <property name="id" elementName="cl_id" xmlAttribute="true" use="REQUIRED" />
            <property name="syncData.serverId" elementName="id" xmlAttribute="true" includeNullValues="false"/>
            <property name="tbcase.syncData.serverId" elementName="tbcase" xmlAttribute="true" includeNullValues="false" />
            <property name="tbcase.id" elementName="cl_case" xmlAttribute="true" use="REQUIRED"  />
            <property name="comorbidity.id" elementName="comorbidity" use="REQUIRED" xmlAttribute="true"/>
        	<property name="duration" xmlAttribute="true" />
        </objectGraph>

        <objectGraph name="entityKey" class="org.msh.etbm.sync.EntityKey">
            <property name="entityName" elementName="entity" xmlAttribute="true" />
            <property name="serverId" xmlAttribute="true" />
            <property name="clientId" xmlAttribute="true" />
            <property name="action" xmlAttribute="true" />
        </objectGraph>

        <objectGraph name="deleted-entity" class="org.msh.etbm.entities.DeletedEntity">
            <property name="entityName" elementName="entity" xmlAttribute="true" />
            <property name="entityId" elementName="id" xmlAttribute="true" />
            <property name="id" use="IGNORE" />
        </objectGraph>

        <objectGraph name="field" class="org.msh.etbm.entities.FieldValue">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="shortName.name1" elementName="shortname1" use="REQUIRED" />
            <property name="shortName.name2" elementName="shortname2" />
            <property name="field" xmlAttribute="true" />
            <property name="other" xmlAttribute="true" />
            <property name="displayOrder" xmlAttribute="true" />
            <property name="customId" xmlAttribute="true" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
    </objectCollection>
</graphSchema>
